CREATE TABLE IF NOT EXISTS Avaliacao (
    ID_Avaliacao INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
    ID_Usuario INT NOT NULL,           -- ID do usuário que fez a avaliação
    ID_Jogo INT NOT NULL,              -- ID do jogo avaliado
    Nota INT NOT NULL CHECK (Nota BETWEEN 1 AND 10),  -- Nota de 1 a 10
    Comentario TEXT,                   -- Comentário opcional do usuário
    Data_Avaliacao DATETIME DEFAULT CURRENT_TIMESTAMP,  -- Data da avaliação
    FOREIGN KEY (ID_Usuario) REFERENCES Usuario(ID_Usuario),  -- Chave estrangeira para usuário
    FOREIGN KEY (ID_Jogo) REFERENCES Jogo(App_ID)             -- Chave estrangeira para jogo
);

-- consulta avaliação de jogos
SELECT 
    a.ID_Avaliacao, 
    u.Nome AS Nome_Usuario, 
    a.Nota, 
    a.Comentario, 
    a.Data_Avaliacao
FROM Avaliacao a
JOIN Usuario u ON a.ID_Usuario = u.ID_Usuario
JOIN Jogo j ON a.ID_Jogo = j.App_ID
WHERE a.ID_Jogo = [ID_DO_JOGO];

-- consulta media avaliacao de jogos
SELECT 
    j.Nome AS Nome_Jogo, 
    AVG(a.Nota) AS Media_Avaliacao
FROM Avaliacao a
JOIN Jogo j ON a.ID_Jogo = j.App_ID
WHERE a.ID_Jogo = [ID_DO_JOGO]
GROUP BY j.Nome;
